# --- Blueprint enforcement (UI <-> YAML reconciliation)
enforcement:
  managed_only: true
  protect_roles: ["System Manager", "Administrator"]
  sections:
    users:
      mode: append
    roles:
      mode: sync
      strategy: union_only
    user_permissions:
      mode: sync
      delete: false

# --- Permission policy (consumed by zanaverse_onboarding.permissions)
sensitive_roles:
  "Employee":                        ["HR Manager", "HR Assistant"]
  "Salary Slip":                     ["HR Manager", "Payroll Manager"]
  "Payroll Entry":                   ["HR Manager", "Payroll Manager"]
  "Employee Benefit Application":    ["HR Manager"]
  "Expense Claim":                   ["HR Manager", "Accounts Manager", "Expense Approver"]
  "Journal Entry":                   ["Accounts Manager"]
  "Payment Entry":                   ["Accounts Manager"]
  "Project":                         ["Projects Manager"]
  "Timesheet":                       ["Projects Manager"]

strict_default_deny: true

# Per-doctype PQC config. Company-only scoping (brand_field is blank).
pqc_doctypes:
  # CRM / Sales
  "Lead":             { enabled: true,  company_field: company, brand_field: "" }
  "Opportunity":      { enabled: true,  company_field: company, brand_field: "" }
  "Customer":         { enabled: false, company_field: "",      brand_field: "" }   # no native Company
  "Quotation":        { enabled: true,  company_field: company, brand_field: "" }
  "Sales Order":      { enabled: true,  company_field: company, brand_field: "" }
  "Sales Invoice":    { enabled: true,  company_field: company, brand_field: "" }
  "Delivery Note":    { enabled: true,  company_field: company, brand_field: "" }
  "Payment Entry":    { enabled: true,  company_field: company, brand_field: "" }

  # Buying
  "Supplier":             { enabled: false, company_field: "",       brand_field: "" }
  "Supplier Quotation":   { enabled: true,  company_field: company,  brand_field: "" }
  "Purchase Order":       { enabled: true,  company_field: company,  brand_field: "" }
  "Purchase Receipt":     { enabled: true,  company_field: company,  brand_field: "" }
  "Purchase Invoice":     { enabled: true,  company_field: company,  brand_field: "" }

  # Stock / Operations
  "Warehouse":            { enabled: true,  company_field: company,  brand_field: "" }
  "Stock Entry":          { enabled: true,  company_field: company,  brand_field: "" }
  "Stock Ledger Entry":   { enabled: true,  company_field: company,  brand_field: "" }
  "Item":                 { enabled: false, company_field: "",       brand_field: "" }

  # Projects (company scoping + collab overrides in permissions.py)
  "Project":              { enabled: true,  company_field: company,  brand_field: "" }
  "Task":                 { enabled: true,  company_field: company,  brand_field: "" }
  "Timesheet":            { enabled: true,  company_field: company,  brand_field: "" }

  # HR / Hiring
  "Employee":             { enabled: true,  company_field: company,  brand_field: "" }
  "Job Applicant":        { enabled: false, company_field: "",       brand_field: "" }  # disable unless you add a company link
  "Job Opening":          { enabled: true,  company_field: company,  brand_field: "" }
  "Attendance":           { enabled: true,  company_field: company,  brand_field: "" }
  "Expense Claim":        { enabled: true,  company_field: company,  brand_field: "" }

  # Accounting / Dimensions
  "Journal Entry":        { enabled: true,  company_field: company,  brand_field: "" }
  "Pricing Rule":         { enabled: true,  company_field: company,  brand_field: "" }
  "Cost Center":          { enabled: true,  company_field: company,  brand_field: "" }

pqc_bypass_roles:
  - System Manager
  # - Global Visibility
