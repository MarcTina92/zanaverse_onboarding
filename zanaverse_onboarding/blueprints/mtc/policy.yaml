# --- Blueprint enforcement (UI <-> YAML reconciliation)
enforcement:
  managed_only: true
  protect_roles: ["System Manager", "Administrator"]
  sections:
    users:
      mode: append
    roles:
      mode: sync
      strategy: union_only
    user_permissions:
      mode: sync
      delete: false

# --- Permission policy (consumed by zanaverse_onboarding.permissions)
sensitive_roles:
  "Employee":                        ["HR Manager", "HR Assistant"]
  "Salary Slip":                     ["HR Manager", "Payroll Manager"]
  "Payroll Entry":                   ["HR Manager", "Payroll Manager"]
  "Employee Benefit Application":    ["HR Manager"]
  "Expense Claim":                   ["HR Manager", "Accounts Manager", "Expense Approver"]
  "Journal Entry":                   ["Accounts Manager"]
  "Payment Entry":                   ["Accounts Manager"]
  "Project":                         ["Projects Manager"]
  "Timesheet":                       ["Projects Manager"]

strict_default_deny: false

# Per-doctype PQC config. Company-only scoping (brand_field is blank).
pqc_doctypes:
  # CRM / Sales
  "Lead":             { enabled: false,  company_field: company, brand_field: "" }
  "Opportunity":      { enabled: false,  company_field: company, brand_field: "" }
  "Customer":         { enabled: false, company_field: "",      brand_field: "" }   # no native Company
  "Quotation":        { enabled: false,  company_field: company, brand_field: "" }
  "Sales Order":      { enabled: false,  company_field: company, brand_field: "" }
  "Sales Invoice":    { enabled: false,  company_field: company, brand_field: "" }
  "Delivery Note":    { enabled: false,  company_field: company, brand_field: "" }
  "Payment Entry":    { enabled: false,  company_field: company, brand_field: "" }

  # Buying
  "Supplier":             { enabled: false, company_field: "",       brand_field: "" }
  "Supplier Quotation":   { enabled: false,  company_field: company,  brand_field: "" }
  "Purchase Order":       { enabled: false,  company_field: company,  brand_field: "" }
  "Purchase Receipt":     { enabled: false,  company_field: company,  brand_field: "" }
  "Purchase Invoice":     { enabled: false,  company_field: company,  brand_field: "" }

  # Stock / Operations
  "Warehouse":            { enabled: false,  company_field: company,  brand_field: "" }
  "Stock Entry":          { enabled: false,  company_field: company,  brand_field: "" }
  "Stock Ledger Entry":   { enabled: false,  company_field: company,  brand_field: "" }
  "Item":                 { enabled: false, company_field: "",       brand_field: "" }

  # Projects (company scoping + collab overrides in permissions.py)
  "Project":              { enabled: false,  company_field: "",  brand_field: "" }
  "Task":                 { enabled: false,  company_field: company,  brand_field: "" }
  "Timesheet":            { enabled: false,  company_field: company,  brand_field: "" }

  # HR / Hiring
  "Employee":             { enabled: false,  company_field: company,  brand_field: "" }
  "Job Applicant":        { enabled: false, company_field: "",       brand_field: "" }  # disable unless you add a company link
  "Job Opening":          { enabled: false,  company_field: company,  brand_field: "" }
  "Attendance":           { enabled: false,  company_field: company,  brand_field: "" }
  "Expense Claim":        { enabled: false,  company_field: company,  brand_field: "" }

  # Accounting / Dimensions
  "Journal Entry":        { enabled: false,  company_field: company,  brand_field: "" }
  "Pricing Rule":         { enabled: false,  company_field: company,  brand_field: "" }
  "Cost Center":          { enabled: false,  company_field: company,  brand_field: "" }

pqc_bypass_roles:
  - System Manager
  - HR Manager
  - HR User
  # - Global Visibility

collab:
  on_task_assignment: share_write   # one of: share_write | project_user | none
  ignore_user_permissions_on_task_project: false

project_field_privacy:
  enabled: false
  permlevel: 1
  fields:
    - total_costing_amount
    - total_billed_amount
    - total_purchase_cost
    - total_expense_claim
    - gross_margin
    - per_gross_margin
    - margin 
  level1_roles:
    - Accounts User
    - Accounts Manager
  strict_sync: true
  create_if_missing: true

# policy.yaml
task_field_privacy:
  enabled: false
  permlevel: 1
  fields:
    - total_costing_amount
    - total_expense_claim
    - total_billing_amount
  level1_roles:
    - Accounts User
    - Accounts Manager
  strict_sync: true         # remove other roles' read @ L1
  create_if_missing: true
